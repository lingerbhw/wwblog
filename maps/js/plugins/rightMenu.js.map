{"version":3,"file":"../../../js/plugins/rightMenu.js","names":["RightMenu","rightMenuConfig","volantis","GLOBAL_CONFIG","plugins","rightmenu","messageRightMenu","message","enable","fn","_rightMenuWrapper","document","getElementById","_rightMenuContent","_printHtml","_menuMusic","_readingModel","_readBkg","_menuLoad","querySelectorAll","_menuOption","querySelector","_searchWord","_copyText","_copyPaste","_copySelect","_copyCut","_copyHref","_copySrc","_copyImg","_openTab","_backward","_toggle","_forward","urlRegx","init","DOMController","visible","parentNode","removeChild","readBkg","createElement","className","id","window","body","appendChild","initEvent","oncontextmenu","event","ctrlKey","offsetWidth","hideMenu","popMenu","stopPropagation","preventDefault","removeEventListener","addEventListener","onclick","e","RightMenuAplayer","aplayerBackward","aplayerToggle","aplayerForward","mouseClientX","clientX","mouseClientY","clientY","screenWidth","documentElement","clientWidth","screenHeight","clientHeight","setMenuItem","focus","style","zIndex","menuWidth","menuHeight","offsetHeight","showLeft","showTop","left","top","notice","showMessage","error","blur","console","NoticeRightMenu","localStorage","getItem","VolantisApp","icon","faicon","time","setItem","optionFlag","eventTarget","target","selectText","getSelection","toString","tagName","toLowerCase","inputStr","value","length","select","statrPos","selectionStart","endPos","selectionEnd","copyString","substring","readClipboard","then","text","insertAtCaret","catch","err","eventHref","href","test","open","eventSrc","currentSrc","trimEnd","endsWith","writeClipImg","flag","OpenSearch","_printArticle","pathName","location","pathname","question","printHtml","readingModel","aplayer","undefined","APlayer","player","music_alwaysShow","status","forEach","ele","layout","includes","checkAPlayer","str","utilWriteClipText","messageCopyright","writeClipText","navigator","clipboard","writeText","Promise","resolve","reject","input","setAttribute","result","execCommand","async","success","customPicUrl","replace","old","new","parentElement","data","fetch","blob","write","ClipboardItem","type","dom","createTextRange","textRange","moveToElementText","selection","range","createRange","selectNodeContents","removeAllRanges","addRange","permissions","query","name","state","readText","elemt","startPos","scrollTop","isReadModel","remove","setStyle","setTimeout","print","innerHTML","reload","ScrollReveal","clean","fadeToggle","toggleClass","option","backgroundColor","hasClass","destroy","Object","freeze","requestAnimationFrame","readyState","pjax","send"],"sources":["js/plugins/rightMenu.js"],"mappings":"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","sourcesContent":["const RightMenu = (() => {\n  const\n    rightMenuConfig = volantis.GLOBAL_CONFIG.plugins.rightmenu,\n    messageRightMenu = volantis.GLOBAL_CONFIG.plugins.message.enable && volantis.GLOBAL_CONFIG.plugins.message.rightmenu.enable;\n\n  const\n    fn = {},\n    _rightMenuWrapper = document.getElementById('rightmenu-wrapper'),\n    _rightMenuContent = document.getElementById('rightmenu-content'),\n    _printHtml = document.getElementById('printHtml'),\n    _menuMusic = document.getElementById('menuMusic'),\n    _readingModel = document.getElementById('readingModel'),\n    _readBkg = document.getElementById('read_bkg');\n\n  const\n    _menuLoad = document.querySelectorAll('.menuLoad-Content'),\n    _menuOption = document.querySelector('.menu-Option'),\n    _searchWord = document.querySelector('.menu-Option[data-fn-type=\"searchWord\"]'),\n    _copyText = document.querySelector('.menu-Option[data-fn-type=\"copyText\"]'),\n    _copyPaste = document.querySelector('.menu-Option[data-fn-type=\"copyPaste\"]'),\n    _copySelect = document.querySelector('.menu-Option[data-fn-type=\"copySelect\"]'),\n    _copyCut = document.querySelector('.menu-Option[data-fn-type=\"copyCut\"]'),\n    _copyHref = document.querySelector('.menu-Option[data-fn-type=\"copyHref\"]'),\n    _copySrc = document.querySelector('.menu-Option[data-fn-type=\"copySrc\"]'),\n    _copyImg = document.querySelector('.menu-Option[data-fn-type=\"copyImg\"]'),\n    _openTab = document.querySelector('.menu-Option[data-fn-type=\"openTab\"]'),\n    _backward = document.querySelector('#menuMusic .backward'),\n    _toggle = document.querySelector('#menuMusic .toggle'),\n    _forward = document.querySelector('#menuMusic .forward');\n\n  const urlRegx = /^((https|http)?:\\/\\/)+[A-Za-z0-9]+\\.[A-Za-z0-9]+[\\/=\\?%\\-&_~`@[\\]\\':+!]*([^<>\\\"\\\"])*$/;\n\n  fn.init = () => {\n    DOMController.visible(_menuMusic, false);\n    DOMController.visible(_menuOption, false);\n    if (_readBkg) _readBkg.parentNode.removeChild(_readBkg);\n\n    const readBkg = document.createElement(\"div\");\n    readBkg.className = \"common_read_bkg common_read_hide\";\n    readBkg.id = \"read_bkg\";\n    window.document.body.appendChild(readBkg);\n  }\n\n  fn.initEvent = () => {\n    window.document.oncontextmenu = (event) => {\n      if (event.ctrlKey || document.body.offsetWidth <= 500) {\n        fn.hideMenu();\n        return true;\n      }\n      return fn.popMenu(event);\n    }\n\n    _rightMenuWrapper.oncontextmenu = (event) => {\n      event.stopPropagation();\n      event.preventDefault();\n      return false;\n    }\n\n    window.removeEventListener('blur', fn.hideMenu);\n    window.addEventListener('blur', fn.hideMenu);\n    document.body.removeEventListener('click', fn.hideMenu);\n    document.body.addEventListener('click', fn.hideMenu);\n\n    if (_forward && _toggle && _forward) {\n      _backward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerBackward();\n      }\n      _toggle.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerToggle();\n      }\n      _forward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerForward();\n      }\n    }\n  }\n\n  // 菜单位置设定\n  fn.popMenu = (event) => {\n    let mouseClientX = event.clientX;\n    let mouseClientY = event.clientY;\n    let screenWidth = document.documentElement.clientWidth || document.body.clientWidth;\n    let screenHeight = document.documentElement.clientHeight || document.body.clientHeight;\n\n    try {\n      fn.setMenuItem(event);\n      DOMController.visible(_rightMenuWrapper);\n      _rightMenuWrapper.focus();\n      _rightMenuWrapper.style.zIndex = '-2147483648';\n      let menuWidth = _rightMenuContent.offsetWidth;\n      let menuHeight = _rightMenuContent.offsetHeight;\n      let showLeft = mouseClientX + menuWidth > screenWidth ? mouseClientX - menuWidth + 10 : mouseClientX;\n      let showTop = mouseClientY + menuHeight > screenHeight ? mouseClientY - menuHeight + 10 : mouseClientY;\n      showTop = mouseClientY + menuHeight > screenHeight && showTop < menuHeight && mouseClientY < menuHeight ?\n        showTop + (screenHeight - menuHeight - showTop - 10) : showTop;\n      _rightMenuWrapper.style.left = showLeft + \"px\";\n      _rightMenuWrapper.style.top = showTop + \"px\";\n      _rightMenuWrapper.style.zIndex = '2147483648';\n      if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) fn.showMessage();\n    } catch (error) {\n      _rightMenuWrapper.blur();\n      console.error(error);\n      return true;\n    }\n\n    return false;\n  }\n\n  // 消息提示\n  fn.showMessage = () => {\n    const NoticeRightMenu = localStorage.getItem('NoticeRightMenu') === 'true';\n    if (messageRightMenu && !NoticeRightMenu)\n      VolantisApp.message('右键菜单', '唤醒原系统菜单请使用：<kbd>Ctrl</kbd> + <kbd>右键</kbd>', {\n        icon: rightMenuConfig.faicon + ' fa-exclamation-square red',\n        time: 9000\n      }, () => {\n        localStorage.setItem('NoticeRightMenu', 'true')\n      });\n  }\n\n  // 菜单项设置\n  fn.setMenuItem = (event) => {\n    let optionFlag = false;\n    const eventTarget = event.target;\n    const selectText = window.getSelection().toString();\n    DOMController.visible(_openTab, false); // 隐藏新标签页打开\n\n    // 判断是否是输入框\n    if (eventTarget.tagName.toLowerCase() === 'input' || eventTarget.tagName.toLowerCase() === 'textarea') {\n      const inputStr = eventTarget.value;\n\n      // 全选\n      if (inputStr.length > 0) {\n        DOMController.visible(_copySelect);\n        _copySelect.onclick = () => {\n          event.preventDefault();\n          eventTarget.select();\n        }\n      } else {\n        DOMController.visible(_copySelect, false);\n      }\n\n      // 剪切\n      if (selectText) {\n        DOMController.visible(_copyCut);\n        _copyCut.onclick = () => {\n          const statrPos = eventTarget.selectionStart;\n          const endPos = eventTarget.selectionEnd;\n          fn.copyString(selectText);\n          eventTarget.value = inputStr.substring(0, statrPos) + inputStr.substring(endPos, inputStr.length);\n          eventTarget.selectionStart = statrPos;\n          eventTarget.selectionEnd = statrPos;\n          eventTarget.focus();\n        }\n      } else {\n        DOMController.visible(_copyCut, false);\n      }\n\n      // 粘贴\n      fn.readClipboard().then(text => {\n        // 如果剪切板存在内容\n        if (!!text) {\n          DOMController.visible(_copyPaste);\n          _copyPaste.onclick = () => {\n            fn.insertAtCaret(eventTarget, text);\n          }\n        } else {\n          DOMController.visible(_copyPaste, false);\n        }\n      }).catch((err) => {\n        console.error(err);\n        DOMController.visible(_copyPaste, false);\n      });\n    } else {\n      DOMController.visible(_copySelect, false);\n      DOMController.visible(_copyPaste, false);\n      DOMController.visible(_copyCut, false);\n    }\n\n    // 新标签打开链接\n    const eventHref = eventTarget.href;\n    if (!!eventHref && urlRegx.test(eventHref)) {\n      optionFlag = true;\n      DOMController.visible(_copyHref);\n      DOMController.visible(_openTab);\n      if (_copyHref) _copyHref.onclick = () => {\n        fn.copyString(eventHref);\n      }\n      _openTab.onclick = () => {\n        window.open(eventHref);\n      }\n    } else {\n      DOMController.visible(_copyHref, false);\n    }\n\n    // 新标签打开图片 & 复制图片链接\n    const eventSrc = eventTarget.currentSrc;\n    if (!!eventSrc && urlRegx.test(eventSrc)) {\n      optionFlag = true;\n      DOMController.visible(_copySrc);\n      DOMController.visible(_openTab);\n\n      _copySrc.onclick = () => {\n        fn.copyString(eventSrc);\n      }\n\n      _openTab.onclick = () => {\n        window.open(eventSrc);\n      }\n    } else {\n      DOMController.visible(_copySrc, false);\n    }\n\n    // 复制图片\n    if (!!eventSrc && urlRegx.test(eventSrc) && eventSrc.trimEnd().endsWith('.png')) {\n      optionFlag = true;\n      DOMController.visible(_copyImg);\n\n      _copyImg.onclick = () => {\n        fn.writeClipImg(event, flag => {\n          if (flag && messageRightMenu) VolantisApp.message('系统提示', '图片复制成功！', {\n            icon: rightMenuConfig.faicon + ' fa-images'\n          });\n        }, (error) => {\n          if (messageRightMenu) VolantisApp.message('系统提示', '复制失败：' + error, {\n            icon: rightMenuConfig.faicon + ' fa-exclamation-square red'\n          });\n        })\n      }\n    } else {\n      DOMController.visible(_copyImg, false);\n    }\n\n    // 复制文本\n    if (selectText) {\n      optionFlag = true;\n      DOMController.visible(_copyText);\n      DOMController.visible(_searchWord);\n\n      _copyText.onclick = () => {\n        fn.copyString(selectText);\n      }\n\n      !!_searchWord && (_searchWord.onclick = () => {\n        OpenSearch(selectText);\n      })\n    } else {\n      DOMController.visible(_copyText, false);\n      DOMController.visible(_searchWord, false);\n    }\n\n    // 打印\n    const _printArticle = document.querySelector('#post.article') || null;\n    const pathName = window.location.pathname;\n    if (!!_printArticle) {\n      DOMController.visible(_printHtml);\n      DOMController.visible(_readingModel);\n\n      if (_printHtml) {\n        _printHtml.onclick = () => {\n          if (window.location.pathname === pathName) {\n            const message = '是否打印当前页面？<br><em style=\"font-size: 80%\">建议打印时勾选背景图形</em><br>';\n            if (messageRightMenu) VolantisApp.question('', message, {}, () => {\n              fn.printHtml();\n            })\n          } else {\n            fn.hideMenu();\n          }\n        }\n      }\n\n      if (_readingModel) {\n        _readingModel.onclick = () => {\n          if (window.location.pathname === pathName) {\n            fn.readingModel();\n          } else {\n            fn.readingModel();\n          }\n        }\n      }\n\n    } else {\n      DOMController.visible(_printHtml, false);\n      DOMController.visible(_readingModel, false);\n    }\n\n    if (volantis.GLOBAL_CONFIG.plugins.aplayer.enable\n      && typeof RightMenuAplayer !== 'undefined'\n      && RightMenuAplayer.APlayer.player !== undefined) {\n      if (rightMenuConfig.music_alwaysShow) {\n        DOMController.visible(_menuMusic);\n      } else if (RightMenuAplayer.APlayer.status === 'play' || RightMenuAplayer.APlayer.status === 'undefined') {\n        optionFlag = true;\n        DOMController.visible(_menuMusic);\n      } else {\n        DOMController.visible(_menuMusic, false);\n      }\n    } else {\n      DOMController.visible(_menuMusic, false);\n    }\n\n    _menuLoad.forEach(ele => {\n      DOMController.visible(ele, !optionFlag);\n    })\n\n    if (volantis.GLOBAL_CONFIG.plugins.aplayer.enable\n      && rightMenuConfig.layout.includes('music')) {\n      RightMenuAplayer.checkAPlayer();\n    }\n  }\n\n  // 隐藏菜单\n  fn.hideMenu = () => {\n    DOMController.visible(_rightMenuWrapper, false);\n  }\n\n  // 复制字符串\n  fn.copyString = (str) => {\n    VolantisApp.utilWriteClipText(str)\n      .then(() => {\n        if (messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.faicon + ' fa-exclamation-square red'\n          });\n        }\n      })\n  }\n\n  // 写入文本到剪切板\n  fn.writeClipText = (str) => {\n    try {\n      return navigator.clipboard\n        .writeText(str)\n        .then(() => {\n          return Promise.resolve()\n        })\n        .catch(err => {\n          return Promise.reject(err)\n        })\n    } catch (e) {\n      const input = document.createElement('input');\n      input.setAttribute('readonly', 'readonly');\n      document.body.appendChild(input);\n      input.setAttribute('value', str);\n      input.select();\n      try {\n        let result = document.execCommand('copy')\n        document.body.removeChild(input);\n        if (!result || result === 'unsuccessful') {\n          return Promise.reject('复制文本失败!')\n        } else {\n          return Promise.resolve()\n        }\n      } catch (e) {\n        document.body.removeChild(input);\n        return Promise.reject(\n          '当前浏览器不支持复制功能，请检查更新或更换其他浏览器操作!'\n        )\n      }\n    }\n  }\n\n  // 写入图片到剪切板\n  fn.writeClipImg = async function (event, success, error) {\n    const eventSrc = rightMenuConfig.customPicUrl.enable ?\n      event.target.currentSrc.replace(rightMenuConfig.customPicUrl.old, rightMenuConfig.customPicUrl.new) :\n      event.target.currentSrc;\n    const parentElement = event.target.parentElement;\n    try {\n      const data = await fetch(eventSrc);\n      const blob = await data.blob();\n      await navigator.clipboard\n        .write([\n          new ClipboardItem({\n            [blob.type]: blob\n          })\n        ]).then(() => {\n          success(true);\n        }, (e) => {\n          console.error('图片复制失败：', e);\n          error(e);\n        });\n    } catch (e) {\n      const dom = document;\n      try {\n        if (dom.body.createTextRange) {\n          const textRange = document.body.createTextRange();\n          textRange.moveToElementText(parentElement);\n          textRange.select();\n        } else if (window.getSelection) {\n          const selection = window.getSelection();\n          const range = document.createRange();\n          range.selectNodeContents(parentElement);\n          selection.removeAllRanges();\n          selection.addRange(range);\n        }\n        document.execCommand('copy');\n        window.getSelection().removeAllRanges();\n        success(false);\n      } catch (e) {\n        console.error(e);\n        error('不支持复制当前图片！');\n      }\n    }\n  }\n\n  // 请求读取剪切板\n  fn.readClipboard = async () => {\n    const result = await navigator.permissions.query({\n      name: 'clipboard-read'\n    });\n    if (result.state === 'granted' || result.state === 'prompt') {\n      // 修改为 .read()  可以获取剪切板中的文字/图片\n      // 返回的是 ClipboardItem\n      return navigator.clipboard\n        .readText()\n        .then(text => text)\n        .catch(err => Promise.reject(err));\n    }\n    return Promise.reject(result);\n  }\n\n  // 粘贴文本\n  fn.insertAtCaret = (elemt, value) => {\n    const startPos = elemt.selectionStart,\n      endPos = elemt.selectionEnd;\n    if (document.selection) {\n      elemt.focus();\n      var sel = document.selection.createRange();\n      sel.text = value;\n      elemt.focus();\n    } else {\n      if (startPos || startPos == '0') {\n        var scrollTop = elemt.scrollTop;\n        elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);\n        elemt.focus();\n        elemt.selectionStart = startPos + value.length;\n        elemt.selectionEnd = startPos + value.length;\n        elemt.scrollTop = scrollTop;\n      } else {\n        elemt.value += value;\n        elemt.focus();\n      }\n    }\n  }\n\n  // 执行打印页面\n  fn.printHtml = () => {\n    if (volantis.isReadModel) fn.readingModel();\n    DOMController.setAttribute('details', 'open', 'true');\n    DOMController.remove('.cus-article-bkg');\n    DOMController.remove('.iziToast-overlay');\n    DOMController.remove('.iziToast-wrapper');\n    DOMController.remove('.prev-next');\n    DOMController.remove('footer');\n    DOMController.remove('#l_header');\n    DOMController.remove('#l_cover');\n    DOMController.remove('#l_side');\n    DOMController.remove('#comments');\n    DOMController.remove('#s-top');\n    DOMController.remove('#BKG');\n    DOMController.remove('#rightmenu-wrapper');\n    DOMController.remove('.nav-tabs');\n    DOMController.remove('.parallax-mirror');\n    DOMController.remove('.new-meta-item.share');\n    DOMController.remove('div.footer');\n    DOMController.setStyle('body', 'backgroundColor', 'unset');\n    DOMController.setStyle('#l_main', 'width', '100%');\n    DOMController.setStyle('#post', 'boxShadow', 'none');\n    DOMController.setStyle('#post', 'background', 'none');\n    DOMController.setStyle('#post', 'padding', '0');\n    DOMController.setStyle('h1', 'textAlign', 'center');\n    DOMController.setStyle('h1', 'fontWeight', '600');\n    DOMController.setStyle('h1', 'fontSize', '2rem');\n    DOMController.setStyle('h1', 'marginBottom', '20px');\n    DOMController.setStyle('.tab-pane', 'display', 'block');\n    DOMController.setStyle('.tab-content', 'borderTop', 'none');\n    DOMController.setStyle('.highlight>table pre', 'whiteSpace', 'pre-wrap');\n    DOMController.setStyle('.highlight>table pre', 'wordBreak', 'break-all');\n    DOMController.setStyle('.fancybox img', 'height', 'auto');\n    DOMController.setStyle('.fancybox img', 'weight', 'auto');\n\n    setTimeout(() => {\n      window.print();\n      document.body.innerHTML = '';\n      window.location.reload();\n    }, 50);\n  }\n\n  // 阅读模式\n  fn.readingModel = () => {\n    if (typeof ScrollReveal === 'function') ScrollReveal().clean('#comments');\n    DOMController.fadeToggle(document.querySelector('#l_header'))\n    DOMController.fadeToggle(document.querySelector('footer'))\n    DOMController.fadeToggle(document.querySelector('#s-top'))\n    DOMController.fadeToggle(document.querySelector('.article-meta#bottom'))\n    DOMController.fadeToggle(document.querySelector('.prev-next'))\n    DOMController.fadeToggle(document.querySelector('#l_side'))\n    DOMController.fadeToggle(document.querySelector('#comments'))\n\n    DOMController.toggleClass(document.querySelector('#l_main'), 'common_read')\n    DOMController.toggleClass(document.querySelector('#l_main'), 'common_read_main')\n    DOMController.toggleClass(document.querySelector('#l_body'), 'common_read')\n    DOMController.toggleClass(document.querySelector('#safearea'), 'common_read')\n    DOMController.toggleClass(document.querySelector('#pjax-container'), 'common_read')\n    DOMController.toggleClass(document.querySelector('#read_bkg'), 'common_read_hide')\n    DOMController.toggleClass(document.querySelector('h1'), 'common_read_h1')\n    DOMController.toggleClass(document.querySelector('#post'), 'post_read')\n    DOMController.toggleClass(document.querySelector('#l_cover'), 'read_cover')\n    DOMController.toggleClass(document.querySelector('.widget.toc-wrapper'), 'post_read')\n\n    volantis.isReadModel = volantis.isReadModel === undefined ? true : !volantis.isReadModel;\n    if (volantis.isReadModel) {\n      const option = {\n        backgroundColor: 'var(--color-read-post)',\n        icon: rightMenuConfig.faicon + ' fa-book-reader',\n        time: 5000\n      }\n      if (messageRightMenu) VolantisApp.message('系统提示', '阅读模式已开启，您可以点击屏幕空白处退出。', option);\n      document.querySelector('#l_body').removeEventListener('click', fn.readingModel);\n      document.querySelector('#l_body').addEventListener('click', (event) => {\n        if (DOMController.hasClass(event.target, 'common_read')) {\n          fn.readingModel();\n        }\n      });\n    } else {\n      document.querySelector('#l_body').removeEventListener('click', fn.readingModel);\n      document.querySelector('#post').removeEventListener('click', fn.readingModel);\n    }\n  }\n\n  return {\n    init: (notice = false) => {\n      fn.init();\n      fn.initEvent();\n      if (notice && messageRightMenu) VolantisApp.message('系统提示', '自定义右键注册成功。');\n    },\n    destroy: (notice = false) => {\n      fn.hideMenu();\n      window.document.oncontextmenu = () => {\n        return true\n      };\n      if (notice && messageRightMenu) VolantisApp.message('系统提示', '自定义右键注销成功。');\n    },\n    hideMenu: fn.hideMenu,\n    readingModel: fn.readingModel\n  }\n})()\n\nObject.freeze(RightMenu);\n\nvolantis.requestAnimationFrame(() => {\n  if (document.readyState !== 'loading') {\n    RightMenu.init();\n\n    volantis.pjax.send(() => {\n      RightMenu.hideMenu();\n    })\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", function () {\n      RightMenu.init();\n\n      volantis.pjax.send(() => {\n        RightMenu.hideMenu();\n      })\n    })\n  }\n});\n"]}